{"id":"meld-eq0","title":"Meld v1: Multi-Model Plan Convergence Tool","description":"# Meld v1 Epic\n\n## Vision\nMeld is a Python CLI tool that orchestrates multi-model plan convergence. Given a task description, it uses Claude as the \"Melder\" to generate an initial plan, then collects parallel feedback from three AI advisors (Claude CLI, Gemini CLI, Codex CLI), synthesizes the feedback, and iterates until convergence or max rounds.\n\n## Why This Matters\n- **Model Diversity**: Different AI models have different strengths, blind spots, and perspectives. Combining their feedback produces more robust plans than any single model.\n- **Convergence as Quality Signal**: When multiple models agree a plan is complete, confidence is higher. Disagreement surfaces risks and edge cases.\n- **Human-in-the-Loop**: The DEFERRED items mechanism ensures humans make final calls on contested decisions.\n\n## Key Design Goals\n1. **Advisor Adapter Layer**: Encapsulate per-CLI quirks (flags, output parsing) so CLI drift doesn't break the core loop\n2. **Session Persistence**: Crash-safe artifacts enable debugging, `--resume`, and meet PRD requirement \"no data loss if interrupted\"\n3. **Structured Feedback**: Lightly structured advisor responses improve synthesis quality and convergence accuracy\n4. **Real-time Visibility**: Textual TUI shows all four models working in parallel with streaming output\n\n## Architecture Summary\n- **Language**: Python 3.10+ (required for Textual/Rich; modern async support)\n- **TUI Framework**: Textual (purpose-built for terminal apps; handles layout, streaming, async natively)\n- **CLI Invocation**: asyncio.create_subprocess_exec (non-blocking parallel execution; stdout streaming)\n- **Output Format**: Markdown + optional JSON (Markdown for humans, JSON for CI/scripting)\n- **Configuration**: CLI flags only (no config files for v1; keeps it simple)\n\n## Implementation Phases\n1. **Foundation**: Project scaffolding, CLI, session manager, provider interface\n2. **Core Logic**: All provider adapters, Melder, Advisor pool, convergence detection\n3. **TUI**: Textual app with 4-panel layout, streaming, status indicators\n4. **Polish**: Output formatter, JSON output, resume, graceful degradation\n\n## Success Criteria\n- All CLIs invoked successfully when available\n- Preflight detects missing/broken CLIs with actionable messages\n- TUI renders without flicker with throttled updates\n- Convergence detection: no false positives; OPEN_ITEMS \u003e 0 always blocks\n- Graceful degradation: works with 2/3 advisors\n- Session artifacts enable crash recovery via --resume\n\n## Dependencies\n### External (user must have installed)\n- `claude` CLI - Anthropic's Claude Code CLI (authenticated)\n- `gemini` CLI - Google's Gemini CLI (authenticated)\n- `codex` CLI - OpenAI's Codex CLI (authenticated)\n- Python 3.10+\n\n### Python Packages\n- `textual\u003e=0.50.0` - TUI framework\n- `rich\u003e=13.0.0` - Terminal formatting (Textual dependency)\n\n## Deferred to v1.1\n- Event-driven architecture (event bus for TUI/logging separation)\n- Context size guardrails (--max-context-chars, PRD summarization)\n- Semantic oscillation detection\n- Advisor specialization hints\n- Cost tracking and token usage estimation","status":"open","priority":1,"issue_type":"epic","owner":"mjfork@users.noreply.github.com","created_at":"2026-01-15T22:58:31.635092-06:00","created_by":"Michael Fork","updated_at":"2026-01-15T22:58:31.635092-06:00","labels":["epic","python","tui","v1"]}
{"id":"meld-eq0.1","title":"Task 1: Project Setup \u0026 CLI Foundation","description":"# Task 1: Project Setup \u0026 CLI Foundation\n\n## Overview\nEstablish the Python project structure and implement the CLI entry point with all input modes. This is the foundational layer that everything else builds upon.\n\n## Why This Task Exists\nBefore any business logic can be implemented, we need:\n1. A properly configured Python project with modern tooling (pyproject.toml, proper packaging)\n2. A CLI interface that handles all input modes the user might want\n3. Directory structure that matches the architectural vision\n\n## Design Decisions Made\n\n### Project Structure Choice\nUsing flat `meld/` package structure rather than `src/meld/` because:\n- Simpler for a standalone CLI tool\n- Direct import paths (`from meld.cli import ...`)\n- Standard pattern for single-package projects\n\n### CLI Framework: argparse (stdlib)\nChose argparse over click/typer because:\n- Zero additional dependencies\n- Sufficient for our needs (2 subcommands, ~15 flags)\n- Better control over help formatting\n- No magic decorators to understand\n\n### Input Mode Priority (when multiple provided)\n1. Positional arg (highest priority)\n2. --file flag\n3. stdin (auto-detected when piped)\n\nRationale: Explicit arguments should win over implicit (stdin).\n\n## Technical Requirements\n\n### Directory Structure\n```\nmeld/\n├── __init__.py          # Version, package metadata\n├── __main__.py          # Entry point for python -m meld\n├── cli.py               # argparse setup, subcommands\n├── orchestrator.py      # Main loop (stub for now)\n├── melder.py            # Claude integration (stub)\n├── advisors.py          # Advisor pool (stub)\n├── session.py           # Session management (stub)\n├── preflight.py         # Preflight checks (stub)\n├── tui.py               # Textual app (stub)\n├── output.py            # Output formatting (stub)\n├── signals.py           # Signal handling (stub)\n├── prompts.py           # Prompt templates (stub)\n├── providers/           # Provider adapters\n│   ├── __init__.py\n│   ├── base.py          # Abstract base (stub)\n│   ├── claude.py        # Claude adapter (stub)\n│   ├── gemini.py        # Gemini adapter (stub)\n│   └── openai.py        # OpenAI adapter (stub)\n└── models.py            # Data models/types\n```\n\n### pyproject.toml Requirements\n- Build system: hatchling (modern, fast, minimal config)\n- Python: \u003e=3.10\n- Dependencies: textual\u003e=0.50.0, rich\u003e=13.0.0\n- Entry point: `meld = meld.cli:main`\n- Dev dependencies: pytest, pytest-asyncio, ruff\n\n### CLI Interface\n```bash\n# Main command with task\nmeld run \"Build an auth system\"\n\n# Read from file\nmeld run --file task.txt\n\n# Pipe from stdin\necho \"Build auth\" | meld run\n\n# With PRD context\nmeld run \"Build auth\" --prd requirements.md\n\n# Run options\nmeld run \"Task\" --rounds 5 --timeout 600\nmeld run \"Task\" --output plan.md --json-output summary.json\nmeld run \"Task\" --quiet  # No TUI, stdout output\nmeld run \"Task\" --verbose  # Include raw advisor outputs\n\n# Session management\nmeld run --resume 2026-01-16T02-47-17Z-abc123\nmeld run \"Task\" --run-dir ./custom-runs/\n\n# Skip preflight\nmeld run \"Task\" --skip-preflight\n\n# Doctor subcommand\nmeld doctor\n```\n\n## Acceptance Criteria\n- [ ] `pip install -e .` works from project root\n- [ ] `meld --help` shows usage with all flags documented\n- [ ] `meld run \"task\"` accepts positional argument\n- [ ] `meld run --file task.txt` reads from file\n- [ ] `echo \"task\" | meld run` reads from stdin\n- [ ] `meld run --prd doc.md` loads PRD content\n- [ ] `meld doctor` runs (even if stub)\n- [ ] All flags parse correctly (no errors)\n- [ ] Version displayed with `meld --version`\n\n## Notes for Implementation\n- Start with just the CLI parsing, not the actual execution\n- Stubs should print \"Not implemented yet\" and exit cleanly\n- Use type hints throughout (Python 3.10+ syntax)\n- Include docstrings for public functions","status":"open","priority":1,"issue_type":"task","owner":"mjfork@users.noreply.github.com","created_at":"2026-01-15T22:59:44.858502-06:00","created_by":"Michael Fork","updated_at":"2026-01-15T22:59:44.858502-06:00","labels":["cli","foundation","phase-1"],"dependencies":[{"issue_id":"meld-eq0.1","depends_on_id":"meld-eq0","type":"parent-child","created_at":"2026-01-15T22:59:44.864126-06:00","created_by":"Michael Fork"}]}
{"id":"meld-eq0.1.1","title":"1.1: Create pyproject.toml with modern Python packaging","description":"# Subtask 1.1: Create pyproject.toml\n\n## What to Create\nA modern Python project configuration using pyproject.toml with hatchling build system.\n\n## Why hatchling?\n- Modern, fast, PEP 517/518 compliant\n- Minimal configuration needed\n- Good defaults for package discovery\n- Active development and community support\n\n## File Content Requirements\n\n```toml\n[build-system]\nrequires = [\"hatchling\"]\nbuild-backend = \"hatchling.build\"\n\n[project]\nname = \"meld\"\nversion = \"0.1.0\"\ndescription = \"Multi-model plan convergence orchestrator\"\nreadme = \"README.md\"\nlicense = \"MIT\"\nrequires-python = \"\u003e=3.10\"\nauthors = [\n    { name = \"Your Name\", email = \"you@example.com\" }\n]\nkeywords = [\"ai\", \"cli\", \"planning\", \"convergence\"]\nclassifiers = [\n    \"Development Status :: 3 - Alpha\",\n    \"Environment :: Console\",\n    \"Intended Audience :: Developers\",\n    \"License :: OSI Approved :: MIT License\",\n    \"Programming Language :: Python :: 3.10\",\n    \"Programming Language :: Python :: 3.11\",\n    \"Programming Language :: Python :: 3.12\",\n    \"Topic :: Software Development :: Quality Assurance\",\n]\ndependencies = [\n    \"textual\u003e=0.50.0\",\n    \"rich\u003e=13.0.0\",\n]\n\n[project.optional-dependencies]\ndev = [\n    \"pytest\u003e=7.0\",\n    \"pytest-asyncio\u003e=0.21\",\n    \"ruff\u003e=0.1.0\",\n]\n\n[project.scripts]\nmeld = \"meld.cli:main\"\n\n[project.urls]\nHomepage = \"https://github.com/yourname/meld\"\nDocumentation = \"https://github.com/yourname/meld#readme\"\nRepository = \"https://github.com/yourname/meld\"\n\n[tool.hatch.build.targets.wheel]\npackages = [\"meld\"]\n\n[tool.ruff]\nline-length = 100\ntarget-version = \"py310\"\n\n[tool.ruff.lint]\nselect = [\"E\", \"F\", \"I\", \"UP\", \"B\"]\n\n[tool.pytest.ini_options]\nasyncio_mode = \"auto\"\ntestpaths = [\"tests\"]\n```\n\n## Acceptance Criteria\n- [ ] File exists at project root\n- [ ] `pip install -e .` succeeds\n- [ ] `pip install -e \".[dev]\"` installs dev dependencies\n- [ ] `meld` command is available after install\n\n## Considerations\n- Version starts at 0.1.0 (pre-release, unstable API)\n- MIT license for maximum flexibility\n- Dev dependencies separate to keep production install slim","status":"open","priority":1,"issue_type":"task","owner":"mjfork@users.noreply.github.com","created_at":"2026-01-15T23:00:09.253817-06:00","created_by":"Michael Fork","updated_at":"2026-01-15T23:00:09.253817-06:00","labels":["foundation","packaging"],"dependencies":[{"issue_id":"meld-eq0.1.1","depends_on_id":"meld-eq0.1","type":"parent-child","created_at":"2026-01-15T23:00:09.25725-06:00","created_by":"Michael Fork"}]}
{"id":"meld-eq0.1.2","title":"1.2: Create directory structure with stub modules","description":"# Subtask 1.2: Create Directory Structure\n\n## What to Create\nThe complete directory structure with stub implementations for all modules.\n\n## Directory Layout\n```\nmeld/\n├── __init__.py          # Package init with version\n├── __main__.py          # python -m meld support\n├── cli.py               # CLI entry point (stub)\n├── orchestrator.py      # Main loop\n├── melder.py            # Claude Melder\n├── advisors.py          # Advisor pool\n├── session.py           # Session management\n├── preflight.py         # Preflight checks\n├── tui.py               # Textual TUI\n├── output.py            # Output formatting\n├── signals.py           # Signal handling\n├── prompts.py           # Prompt templates\n├── models.py            # Data classes/types\n└── providers/\n    ├── __init__.py\n    ├── base.py          # Abstract base adapter\n    ├── claude.py        # Claude adapter\n    ├── gemini.py        # Gemini adapter\n    └── openai.py        # OpenAI/Codex adapter\n\ntests/\n├── __init__.py\n├── test_cli.py          # CLI tests (stub)\n└── conftest.py          # pytest fixtures\n```\n\n## Stub Implementation Pattern\nEach module should have a docstring explaining its purpose and any placeholder code:\n\n```python\n\"\"\"\nmeld/orchestrator.py - Main convergence loop.\n\nThis module coordinates the Melder and Advisors through\nthe plan → feedback → synthesis cycle until convergence\nor max rounds reached.\n\"\"\"\n\nasync def run_convergence_loop(task: str, prd: str | None = None) -\u003e str:\n    \"\"\"Run the main convergence loop.\n    \n    Args:\n        task: The task description to plan for\n        prd: Optional PRD content for context\n        \n    Returns:\n        The final converged plan as markdown\n    \"\"\"\n    raise NotImplementedError(\"Orchestrator not yet implemented\")\n```\n\n## __init__.py Content\n```python\n\"\"\"Meld: Multi-model plan convergence orchestrator.\"\"\"\n\n__version__ = \"0.1.0\"\n```\n\n## __main__.py Content\n```python\n\"\"\"Allow running as python -m meld.\"\"\"\nfrom meld.cli import main\n\nif __name__ == \"__main__\":\n    main()\n```\n\n## Why All Stubs Upfront?\n1. **Import validation**: Ensures module structure is correct\n2. **IDE support**: Autocomplete works immediately\n3. **Parallel development**: Multiple developers can work on different modules\n4. **Test scaffolding**: Tests can be written against interfaces\n\n## Acceptance Criteria\n- [ ] All directories exist\n- [ ] All .py files exist with docstrings\n- [ ] `from meld import __version__` works\n- [ ] `python -m meld` runs (even if just prints help)\n- [ ] `from meld.providers.base import ...` imports work\n- [ ] No circular import issues","status":"open","priority":1,"issue_type":"task","owner":"mjfork@users.noreply.github.com","created_at":"2026-01-15T23:00:39.684833-06:00","created_by":"Michael Fork","updated_at":"2026-01-15T23:00:39.684833-06:00","labels":["foundation","structure"],"dependencies":[{"issue_id":"meld-eq0.1.2","depends_on_id":"meld-eq0.1","type":"parent-child","created_at":"2026-01-15T23:00:39.68786-06:00","created_by":"Michael Fork"}]}
